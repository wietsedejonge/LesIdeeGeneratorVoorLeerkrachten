<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spelgenerator voor Leerkrachten</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap">
</head>
<body>

 <!-- Navbar -->
 <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">Spelgenerator voor Leerkrachten</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">
            <li class="nav-item nav-item-1">
            <a class="nav-link" href="#section-1">Home</a>
            </li>
            <li class="nav-item nav-item-2">
            <a class="nav-link" href="#section-2">Over</a>
            </li>
            <li class="nav-item nav-item-3">
            <a class="nav-link" href="#section-3">Spel Generator</a>
            </li>
            <li class="nav-item nav-item-4">
            <a class="nav-link" href="#section-4">Contact</a>
            </li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="container-fluid custom-section" id="section-1">
    <div class="row">
      <div class="col-md-6 mx-auto mt-5">
        <h2 class="text-center">"Een mens is het meest zichzelf als hij de ernst bezit van een spelend kind"</h2>
      </div>
    </div>
  </div>

  <div class="container-fluid custom-section-2" id="section-2">
    <div class="row justify-content-center align-items-center" style="height: 100vh;">
        <div class="col-md-6 section-3-paragraph">
            <h2 class="text-center">Over ons</h2>
            <p class="mt-7 text-center">Wij zijn Karlijn, Lois, Janneke en wij: Lorem ipsum dolor sit amet consectetur adipisicing elit. Necessitatibus beatae quis officiis, magni possimus voluptate nisi et repellendus repellat velit nulla cumque. Necessitatibus expedita explicabo mollitia blanditiis eaque voluptatum labore! Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ratione blanditiis a odit eveniet non saepe eius incidunt animi autem suscipit! Eaque reiciendis est quasi expedita autem iusto vel consequuntur consequatur.</p>
        </div>
        
        <div class="col-md-6 text-center image">
            <img src="img/voordeklas.jpg" alt="Foto Lesgeven" class="img-fluid">
        </div>
    </div>
  </div>


  <div class="container-fluid custom-section-3" id="section-3">
    <div class="row justify-content-center align-items-center" style="height: 100vh;">
        <div class="col-md-10">
            <h2 class="mb-3 text-center">Wereldoriëntatie Spel Generator</h2>
            <div class="box p-5">
                <div id="question1" class="question visible">
                    <h4>Hoe lang mag het spel duren?</h4>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="timePeriod" id="timePeriod15" value="15" required>
                        <label class="form-check-label" for="timePeriod15">15 minuten</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="timePeriod" id="timePeriod15_30" value="15-30">
                        <label class="form-check-label" for="timePeriod15_30">15-30 minuten</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="timePeriod" id="timePeriod30Plus" value="30+">
                        <label class="form-check-label" for="timePeriod30Plus">30+ minuten</label>
                    </div>
                    <button id="next1" class="btn btn-primary mt-3" disabled>Volgende</button>
                </div>
                

                <div id="question2" class="question" style="display: none;">
                    <h4>Voor welke groep is het spel?</h4>
                    <div>
                        <label>
                            <input type="checkbox" id="group3-4" value="3-4"> 3-4
                        </label>
                        <label>
                            <input type="checkbox" id="group5-6" value="5-6"> 5-6
                        </label>
                        <label>
                            <input type="checkbox" id="group7-8" value="7-8"> 7-8
                        </label>
                    </div>
                    <button id="next2" class="btn btn-primary mt-3" disabled>Volgende</button>
                </div>

                <div id="question3" class="question" style="display: none;">
                    <h4>Voor welk vak is het spel?</h4>
                    <div>
                        <input type="radio" id="subjectAardrijkskunde" name="subject" />
                        <label for="subjectAardrijkskunde">Aardrijkskunde</label>
                    </div>
                    <div>
                        <input type="radio" id="subjectGeschiedenis" name="subject" />
                        <label for="subjectGeschiedenis">Geschiedenis</label>
                    </div>
                    <div>
                        <input type="radio" id="subjectNatuurkunde" name="subject" />
                        <label for="subjectNatuurkunde">Natuurkunde</label>
                    </div>
                    <div>
                        <input type="radio" id="subjectBiologie" name="subject" />
                        <label for="subjectBiologie">Biologie</label>
                    </div>
                    <div>
                        <input type="radio" id="subjectTechniek" name="subject" />
                        <label for="subjectTechniek">Techniek</label>
                    </div>
                    <button id="next3" class="btn btn-primary mt-3" disabled>Verzenden</button>
                </div>

                <div id="question4" class="question" style="display: none;">
                    <h4>Wat is het thema van het spel?</h4>
                    <div id="themaContainer">
                    </div>
                    <button id="next4" class="btn btn-primary mt-3" disabled>Volgende</button>
                </div>

                <div id="question5" class="question" style="display: none;">
                    <h4>Wat zijn de onderwerpen?</h4>
                    <div id="onderwerpContainer">
                    </div>
                    <button id="submitFinal" class="btn btn-primary mt-3" disabled>Verzenden</button>
                </div>
                

                <div id="responseMessage" style="display: none;"></div>
            </div>
        </div>
    </div>
</div>


  <div class="container-fluid custom-section-4" id="section-4">
    <div class="row justify-content-center align-items-center" style="height: 100vh;">
        <div class="col-md-6 text-center">
            <h2>Contact</h2>
        </div>

        <div class="col-md-6 pr-5" style="padding-right: 50px;">
            <form class="d-flex flex-column justify-content-center text-center">
                <div class="mb-3">
                    <label for="name" class="form-label">Name</label>
                    <input type="text" class="form-control" id="name" placeholder="Your Name">
                </div>
                <div class="mb-3">
                    <label for="email" class="form-label">Email address</label>
                    <input type="email" class="form-control" id="email" placeholder="Your Email">
                </div>
                <div class="mb-3">
                    <label for="message" class="form-label">Message</label>
                    <textarea class="form-control" id="message" rows="4" placeholder="Your Message"></textarea>
                </div>
                <button type="submit" class="btn btn-primary">Submit</button>
            </form>
        </div>
    </div>
  </div>

    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script>
    function toggleNextButton(questionId, buttonId) {
        const questionContainer = document.getElementById(questionId);
        const inputs = questionContainer.querySelectorAll('input[type="radio"], input[type="checkbox"]');
        const nextButton = document.getElementById(buttonId);
    
        inputs.forEach(input => {
            input.addEventListener('change', function () {
                const isAnySelected = Array.from(inputs).some(input => input.checked);
                nextButton.disabled = !isAnySelected;
            });
        });
    }
    
    toggleNextButton('question1', 'next1');
    toggleNextButton('question2', 'next2');
    toggleNextButton('question3', 'next3');
    toggleNextButton('question4', 'next4');
    toggleNextButton('question5', 'submitFinal');

        function populateThemes(subject) {
        const themaContainer = document.getElementById('themaContainer');
        themaContainer.innerHTML = '';

        let themes = [];
        if (subject === 'Aardrijkskunde') {
            themes = [
                'Geografie van Europa'
                // 'Klimaatverandering',
                // 'Wereldzeeën',
                // 'Steden en hun geschiedenis',
                // 'Natuurverschijnselen'
            ];
        } else if (subject === 'Geschiedenis') {
            themes = [
                'De Tweede Wereldoorlog'
                // 'Romeinse Rijk',
                // 'De Middeleeuwen',
                // 'De Franse Revolutie',
                // 'De Gouden Eeuw'
            ];
        } else if (subject === 'Natuurkunde') {
            themes = [
                'Beweging en Kracht'
                // 'Energiebronnen',
                // 'Magnetisme',
                // 'Elektriciteit',
                // 'Optica'
            ];
        } else if (subject === 'Biologie') {
            themes = [
                'Cellen en Organismen'
                // 'Ecosystemen',
                // 'Genetica',
                // 'Planten en Dieren',
                // 'Menselijk Lichaam'
            ];
        } else if (subject === 'Techniek') {
            themes = [
                'Robots en Automatisering'
                // 'Circuits en Elektronica',
                // 'Machines en Mechanica',
                // '3D-printen',
                // 'Herbruikbare Energie'
            ];
        }

        themes.forEach((theme, index) => {
            const label = document.createElement('label');
            label.innerHTML = `<input type="radio" name="thema" id="thema${index}" value="${theme}"> ${theme}`;
            themaContainer.appendChild(label);
            themaContainer.appendChild(document.createElement('br'));
        });

        toggleNextButtonForThemes();
    }

    function toggleNextButtonForThemes() {
        const themeInputs = document.querySelectorAll('#themaContainer input');
        const submitButton = document.getElementById('next4');

        themeInputs.forEach(input => {
            input.addEventListener('change', function () {
                const isAnySelected = Array.from(themeInputs).some(input => input.checked);
                submitButton.disabled = !isAnySelected;
            });
        });
    }

    function populateSubjects(theme) {
    const onderwerpContainer = document.getElementById('onderwerpContainer');
    onderwerpContainer.innerHTML = '';

    let subjects = [];
    if (theme === 'Geografie van Europa') {
        subjects = ['Landkaarten', 'Bevolking', 'Rivieren', 'Bergen', 'Klimaat'];
    } else if (theme === 'Klimaatverandering') {
        subjects = ['Oorzaken', 'Gevolgen', 'Oplossingen', 'Wetenschap', 'Verdragen'];
    } else if (theme === 'De Tweede Wereldoorlog') {
        subjects = ['Belangrijke gebeurtenissen', 'Leiders', 'Slagvelden', 'Dagelijks leven', 'Gevolgen'];
    } else if (theme === 'Romeinse Rijk') {
        subjects = ['Architectuur', 'Leger', 'Politiek', 'Dagelijks leven', 'Invloed op de wereld'];
    } else if (theme === 'Robots en Automatisering') {
        subjects = ['Geschiedenis van robots', 'Gebruik in industrie', 'Robotica in het dagelijks leven', 'Ethiek', 'Toekomstige trends'];
    }

    subjects.forEach((subject, index) => {
        const label = document.createElement('label');
        label.innerHTML = `<input type="checkbox" name="onderwerp" id="onderwerp${index}" value="${subject}"> ${subject}`;
        onderwerpContainer.appendChild(label);
        onderwerpContainer.appendChild(document.createElement('br'));
    });

    toggleNextButtonForSubjects();
    }

    function toggleNextButtonForSubjects() {
        const subjectInputs = document.querySelectorAll('#onderwerpContainer input');
        const submitButton = document.getElementById('submitFinal');

        subjectInputs.forEach(input => {
            input.addEventListener('change', function () {
                const isAnySelected = Array.from(subjectInputs).some(input => input.checked);
                submitButton.disabled = !isAnySelected;
            });
        });
    }

    function showNextQuestion(currentQuestionId, nextQuestionId) {
        const currentQuestion = document.getElementById(currentQuestionId);
        currentQuestion.classList.remove('visible');
    
        setTimeout(function () {
            currentQuestion.style.display = "none";
            const nextQuestion = document.getElementById(nextQuestionId);
            nextQuestion.style.display = "block";
            setTimeout(function () {
                nextQuestion.classList.add('visible');
            }, 10);
        }, 1500);
    }
    
    function collectAndSubmitData() {
    const groups = [];

    const timePeriodElement = document.querySelector('input[name="timePeriod"]:checked');
    const timePeriod = timePeriodElement 
        ? timePeriodElement.nextElementSibling.innerText 
        : 'Niet geselecteerd';

    if (document.getElementById('group3-4').checked) {
        groups.push('3-4');
    }
    if (document.getElementById('group5-6').checked) {
        groups.push('5-6');
    }
    if (document.getElementById('group7-8').checked) {
        groups.push('7-8');
    }

    const subjectElement = document.querySelector('input[name="subject"]:checked');
    const subject = subjectElement 
        ? subjectElement.nextElementSibling.innerText 
        : 'Niet geselecteerd';

    const themeElement = document.querySelector('#themaContainer input:checked');
    let theme = 'Niet geselecteerd';
    if (themeElement) {
        const labelElement = themeElement.closest('label');
        if (labelElement) {
            theme = labelElement.textContent.trim();
        }
    }

    if (!themeElement) {
        console.log('No theme selected, skipping the response generation.');
        return;
    }

    const question4 = document.getElementById('question4');
    const question5 = document.getElementById('question5');
    question4.classList.remove('visible');
    setTimeout(function () {
        question4.style.display = "none";
        question5.style.display = "block";
        question5.classList.add('visible');
    }, 1500);

    const onderwerpContainer = document.getElementById('onderwerpContainer');
    let question5Responses = [];

    if (onderwerpContainer) {
        const selectedCheckboxes = onderwerpContainer.querySelectorAll('input[type="checkbox"]:checked');
        
        if (selectedCheckboxes.length > 0) {
            selectedCheckboxes.forEach(checkbox => {
                const labelElement = checkbox.closest('label');
                if (labelElement) {
                    question5Responses.push(labelElement.textContent.trim());
                }
            });
        } else {
            console.log('No onderwerpen selected.');
        }
    }

    const prompt = `Genereer een lesspel voor groep ${groups.join(', ')}, vak ${subject}, thema ${theme}, onderwerpen: ${question5Responses.join(', ')}, tijd: ${timePeriod}. Max 150 woorden, focus op speluitleg.`;

    const responseDiv = document.getElementById('responseMessage');

    responseDiv.innerHTML = `
        <div class="d-flex justify-content-center">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
        </div>
    `;
    responseDiv.style.display = "block";

    fetch("https://flask-game-generator.onrender.com/generate", {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
        },
        body: JSON.stringify({ prompt: prompt })
    })
    .then(response => response.json())
    .then(data => {
        const generatedText = data.generated_text || "No response generated.";

        question5.classList.remove('visible');
        setTimeout(function () {
            question5.style.display = "none";
            responseDiv.innerHTML = `
                <h3 class="text-center mb-2">Lesidee:</h3>
                <p>${generatedText}</p>
                <div class="info-row">
                    <div class="info-item">
                        <strong>Vak:</strong> ${subject}
                    </div>
                    <div class="info-item">
                        <strong>Groep:</strong> ${groups.join(', ') || 'Niet geselecteerd'}
                    </div>
                    <div class="info-item">
                        <strong>Tijdsduur:</strong> ${timePeriod}
                    </div>
                    <div class="info-item">
                        <strong>Thema:</strong> ${theme}
                    </div>
                    <div class="info-item">
                    <p><strong>Onderwerpen:</strong> ${question5Responses.join(', ') || 'Niet geselecteerd'}</p>
                    </div>
                </div>
            `;
            responseDiv.style.display = "block"; 
        }, 1500);
    })
    .catch(error => {
        console.error("Error:", error);
        responseDiv.innerHTML = `
            <p style="color: red;">Er is iets misgegaan. Probeer het opnieuw.</p>
        `;
    });
}

 
    document.getElementById('next1').addEventListener('click', function () {
        showNextQuestion('question1', 'question2');
    });
    
    document.getElementById('next2').addEventListener('click', function () {
        showNextQuestion('question2', 'question3');
    });
    
    document.getElementById('next3').addEventListener('click', function () {
        const selectedSubjectElement = document.querySelector('input[name="subject"]:checked');
        const selectedSubject = selectedSubjectElement ? selectedSubjectElement.nextElementSibling.innerText : '';
        
        if (selectedSubject) {
            populateThemes(selectedSubject);
            showNextQuestion('question3', 'question4');
        }
    });
    
    document.getElementById('next4').addEventListener('click', function () {
        const selectedThemeElement = document.querySelector('#themaContainer input:checked');
        const selectedTheme = selectedThemeElement ? selectedThemeElement.value : '';

        if (selectedTheme) {
            populateSubjects(selectedTheme);
            showNextQuestion('question4', 'question5');
        }
    });
    
    document.getElementById('submitFinal').addEventListener('click', function () {
        collectAndSubmitData();
    });
</script>    
</body>
</html>